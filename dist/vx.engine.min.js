!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("vx",[],e):"object"==typeof exports?exports.vx=e():t.vx=e()}(window,(function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);var i=class{constructor(){this.pos={x:0,y:0},this.children=[]}add(t){return this.children.push(t),t}remove(t){return this.children=this.children.filter(e=>e!==t),t}map(t){return this.children.map(t)}update(t,e){this.children=this.children.filter(r=>(r.update&&r.update(t,e,this),!r.dead))}};var n=class{constructor(t,e){const r=document.createElement("canvas");this.w=r.width=t,this.h=r.height=e,this.view=r,this.ctx=r.getContext("2d"),this.ctx.imageSmoothingEnabled=!1,this.ctx.textBaseline="top"}render(t,e=!0){if(0==t.active)return;const{ctx:r,w:i,h:n}=this;e&&r.clearRect(0,0,this.w,this.h),function t(e){e.children.forEach(e=>{if(0!=e.visible){if(r.save(),r.fillStyle="white",r.fillRect(0,0,i,n),e.pos&&r.translate(Math.round(e.pos.x),Math.round(e.pos.y)),e.anchor&&r.translate(e.anchor.x,e.anchor.y),e.scale&&r.scale(e.scale.x,e.scale.y),e.rotation){const t=e.pivot?e.pivot.x:0,i=e.pivot?e.pivot.y:0;r.translate(t,i),r.rotate(e.rotation),r.translate(-t,-i)}if(e.text){const{font:t,fill:i,align:n}=e.style;t&&(r.font=t),i&&(r.fillStyle=i),n&&(r.textAlign=n),r.fillText(e.text,0,0)}else if(e.texture){const t=e.texture.img;e.tileW&&r.drawImage(t,e.frame.x*e.tileW,e.frame.y*e.tileH,e.tileW,e.tileH,0,0,e.tileW,e.tileH)}else e.tileW&&(r.fillStyle="red",r.fillRect(e.pos.x*e.tileW*e.tileH,e.pos.y,e.tileW,e.tileH));e.children&&t(e),r.restore()}})}(t)}};var s=class extends i{constructor(t,e,r,i,n,s){super(),this.mapW=e,this.mapH=r,this.tileW=i,this.tileH=n,this.w=e*i,this.h=r*n,this.type=t}};var o=class extends s{constructor(t,e,r="vx"){const i=Math.ceil(t/32),n=Math.ceil(e/32),s=[];for(let t=0;t<i*n;t++){const e=t%i==0,r=t%i==i-1,o=1==(t/i|0);t<i||Math.floor(t/i)===n-1?s.push({x:2,y:1}):e?s.push({x:1,y:1}):r?s.push({x:3,y:1}):o?s.push({x:4,y:1}):(s.push({x:()=>Math.floor(randf(1,5)),y:0}))}super(r,i,n,32,32,s)}};let a=!1;var l=class{constructor(t){this.w=t.width,this.h=t.height,a=t.debug,this.render=new n(this.w,this.h),t.parent=t.parent||"game",document.querySelector(t.parent)||(document.body.innerHTML='<div id="'+t.parent+'"></div>'),document.getElementById(t.parent).appendChild(this.render.view),this.scene=new o}run(t=(()=>{})){let e=0,r=0,i=0;const n=s=>{requestAnimationFrame(n);const o=s/1e3;e=Math.min(o-r,1/60*5),r=o,i=Math.round(1/e),this.scene.update(e,o),this.render.render(this.scene),a&&t(e,o,i,this.render.ctx)};requestAnimationFrame(n)}};var h=class{constructor(t="",e={}){this.pos={x:0,y:0},this.text=t,this.style=e}};class c{constructor(t=0,e=0){this.x=t,this.y=e}add(t){return t instanceof c?(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=t),this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return t instanceof c?(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=t),this}normalize(t=1){let e=this.Length();return e>0?this.Multiply(t/e):this.Set(t,y=0)}length(){return Math.hypot(this.x,this.y)}}var u={Vector2:c,RGBA:(t=0,e=0,r=0,i=1)=>`rgba(${255*t|0},${255*e|0},${255*r|0},${i})`,rand:function(t,e){return Math.floor(randf(t,e))}};var d=class{constructor(t,e,r=RGBA(255,0,0,1)){this.texture=t,this.pos=e,this.scale=new u.Vector2(1,1),this.pivot=new u.Vector2(0,0),this.rotation=0}};e.default={GameObject:i,Render:n,Scene:o,TileMap:s,Game:l,Text:h,Sprite:d,math:u}}])}));